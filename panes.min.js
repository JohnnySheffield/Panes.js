function CallbackQueue(){this.queue=[];this.length=0}function Bound(e,t){return function(){return t.apply(e,arguments)}}function numberAndRest(e){var t=parseFloat(e);if(isNaN(t)){return false}var n="";if(e!=t){n=e.toString().substr(t.toString().length)}return{number:t,rest:n}}$(function(){DragCapture.init()});DragCapture={_dragging:false,_dragParameters:null,init:function(){this._onMouseDown=Bound(this,this._onMouseDown);this._onMouseMove=Bound(this,this._onMouseMove);this._onMouseUp=Bound(this,this._onMouseUp);this._onKeyDown=Bound(this,this._onKeyDown);this._onKeyUp=Bound(this,this._onKeyUp);$(document).on("mousedown",this._onMouseDown)},onDragStart:new CallbackQueue,_cancelEvent:function(){return false},_findHanlder:function(e,t){var n={onDragMove:null,onDragEnd:null,dragExtra:null};return this.onDragStart.each(function(r){if(r(e,t,n)){return n}})},_onMouseDown:function(e){if(e==null){e=window.event}if(this._dragging){return}if(!(e.button==1&&window.event!=null)&&!(e.button==0)){return true}var t=$(e.target!=null?e.target:e.srcElement);var n={x:e.clientX,y:e.clientY};var r=this._findHanlder(t,n);if(!r){return}this._dragging=true;this._dragParameters=r;this._dragParameters.mouseStart=n;this._dragParameters.mousePrev=n;this._dragParameters.target=t;$(document).on("mousemove",this._onMouseMove).on("mouseup",this._onMouseUp).on("selectstart",this._cancelEvent).on("keydown",this._onKeyDown).on("keyup",this._onKeyUp);document.body.focus();t.bind("dragstart",this._cancelEvent);return false},_onMouseMove:function(e){if(e==null){e=window.event}if(!this._dragging){return}var t={x:e.clientX,y:e.clientY};var n={x:e.clientX-this._dragParameters.mouseStart.x,y:e.clientY-this._dragParameters.mouseStart.y};var r={x:e.clientX-this._dragParameters.mousePrev.x,y:e.clientY-this._dragParameters.mousePrev.y};if(this._dragParameters.onDragMove){var i=this._dragParameters.onDragMove(this._dragParameters.dragExtra,t,n,r);if(i==false){this._onMouseUp()}}this._dragParameters.mousePrev=t},_onMouseUp:function(){if(!this._dragging){return}$(document).off("mousemove",this._onMouseMove).off("mouseup",this._onMouseUp).off("selectstart",this._cancelEvent);if(this._dragParameters.dragTarget){this._dragParameters.dragTarget.unbind("dragstart",this._cancelEvent)}if(this._dragParameters.onDragEnd){this._dragParameters.onDragEnd(this._dragParameters.dragExtra)}this._dragging=false;this._dragParameters=null},_onKeyDown:function(e){if(e==null){e=window.event}if(!this._dragging){return}var t={x:e.clientX-this._dragParameters.mousePrev.x,y:e.clientY-this._dragParameters.mousePrev.y};if(this._dragParameters.onKeyDown){this._dragParameters.onKeyDown(this._dragParameters.dragExtra,e.which,this._dragParameters.mousePrev,t)}},_onKeyUp:function(e){if(e==null){e=window.event}if(!this._dragging){return}var t={x:e.clientX-this._dragParameters.mousePrev.x,y:e.clientY-this._dragParameters.mousePrev.y};if(this._dragParameters.onKeyUp){this._dragParameters.onKeyUp(this._dragParameters.dragExtra,e.which,this._dragParameters.mousePrev,t)}}};(function(){var t=CallbackQueue.prototype;t.register=function(t){if(t){this.queue.push(t)}this.length=this.queue.length};t.unregister=function(t){var n=this.queue.indexOf(t);if(n>-1){this.queue.splice(n,1)}this.length=this.queue.length};t.call=function(){for(var t=0,n;n=this.queue[t];t++){n.apply(null,arguments)}};t.each=function(t){for(var n=0,r;r=this.queue[n];n++){var i=t(r);if(typeof i!="undefined"){return i}}};t.firstToAccept=function(){var t;for(var n=0,r;r=this.queue[n];n++){t=r.apply(null,arguments);if(typeof t!="undefined"){return t}}}})();boundingBox=function(){var t=function(e){this.left=0;this.right=0;this.top=0;this.bottom=0;if(e){this.left=e.left;this.right=e.right;this.top=e.top;this.bottom=e.bottom}};t.prototype.width=function(){return this.right-this.left};t.prototype.height=function(){return this.bottom-this.top};t.prototype.middleVertical=function(){return(this.left+this.right)/2};t.prototype.middleHorizontal=function(){return(this.top+this.bottom)/2};t.prototype.contains=function(e,t){if(!t&&typeof t=="undefined"){t=e.y;e=e.x}return this.left<=e&&e<=this.right&&this.top<=t&&t<=this.bottom};return t}();$.prototype.boundingBox=function(){var e=new boundingBox(this.offset());e.right=e.left+this.outerWidth();e.bottom=e.top+this.outerHeight();return e};$.prototype.boundingBoxes=function(){return this.toArray().map(function(e){return $(e).boundingBox()})};Panes={transitionDuration:350,init:function(){this.initDOM();this.Dividers.init();this.Captions.init();this.ControlBoxes.init()},initDOM:function(){$(":not(.pane-pane) > .pane-container").each(function(e,t){$(t).Container().initDOM(true)});setTimeout(function(){$(".pane-pane").addClass("pane-transition")},Panes.transitionDuration)},Container:function(){function t(e){var t=$(e).closest(".pane-container");if(!t.length){return null}e=t[0];if(!e.containerData){e.containerData=new n(e)}return e.containerData}function n(e){this.els={container:$(e)}}$.fn.Container=function(){return t(this)};var r=n.prototype;r.initDOM=function(e){var t=this.els.container;if(e){var n="<div class='pane-container-placeholder'></div>";var r=t.after(n).next();t.detach()}t.contents().filter(function(e,t){return t.nodeName=="#text"&&$.trim(this.innerHTML)==""}).remove();var i="<span class='pane-divider'></span>";$("> .pane-pane",t).each(function(e,t){t=$(t);t.after(i)});t.prepend(i);$("> .pane-pane",t).each(function(e,t){t=$(t);var n=t.Pane();n.initDOM();if(n.state.hasContainer){$("> * > * > .pane-container",t).Container().initDOM()}});this.initSizes();if(e){r.before(t).remove()}};r.initSizes=function(){var e=this.els.container;var t=e.children(".pane-pane");if(!t.length){return}var n=e.hasClass("pane-vertical");var r=1/t.length;t.each(function(e,t){t.paneData.initSize(n,r)});this.updateSizes()};r.updateSizes=function(){var e=this.els.container;var t=e.children(".pane-pane");var n=t.filter(function(e,t){return!t.paneData.state.isStatic});var r=t.filter(function(e,t){return t.paneData.state.isStatic});var i=e.hasClass("pane-vertical");var s=i?"width":"height";var o=r.toArray().reduce(function(e,t){return e+" + "+t.paneData.state.staticSize},"0px");var u=n.toArray().reduce(function(e,t){return e+t.paneData.state.flexibleSize},0);n.each(function(e,t){var n=t.paneData;t=$(t);var i=n.state.flexibleSize;t.css(s,i/u*100+"%");if(r.length>0){var a="calc((100% - ("+o+")) * "+i/u+")";t.css(s,"-webkit-"+a);t.css(s,a)}});r.each(function(e,t){var n=t.paneData;var r=$(t);r.css(s,n.state.staticSize)})};return t}(),Pane:function(){function t(e){var t=$(e).closest(".pane-pane");if(!t.length){return null}e=t[0];if(!e.paneData){e.paneData=new n(e)}return e.paneData}function n(e){this.els={pane:$(e)};this.state={};this.update();this.loadOptions()}function i(e){var t=numberAndRest(e);if(!t){return false}if(!t.rest){return t.number==0}return["px","cm","mm","in","pt","pc","ex","em","rem","ch","vh","vw","vmin","vmax"].indexOf(t.rest)!=-1}$.fn.Pane=function(){return t(this)};var r=n.prototype;r.update=function(){this.state.isInMiddle=this.els.pane.is(":not(:first-of-type):not(:last-of-type)")};r.loadOptions=function(){try{this.options=JSON.parse(this.els.pane.attr("data-pane-options")||"{}")}catch(e){this.options={}}if(i(this.options.fixedWidth)){this.state.fixedWidth=this.options.fixedWidth}if(i(this.options.fixedHeight)){this.state.fixedHeight=this.options.fixedHeight}};r.initDOM=function(){var e=this.options,t=this.state;var n=this.els.pane;var r=$("<div class='pane-margin'></div>");t.hasCaption=!!e.caption;if(t.hasCaption){n.addClass("pane-has-caption");var i=e.caption.text;var s=$("<div class='pane-caption pane-transition'									  title='"+i+"'></div>");s.append("<div class='pane-caption-text'>"+i+"</div>");r.append(s);var o=$("<div class='pane-control-box'></div>");o.append("<span class='pane-control pane-control-minimize' title='Minimize'></div>");o.append("<span class='pane-control pane-control-maximize' title='Maximize'></div>");o.append("<span class='pane-control pane-control-restore' title='Restore'></div>");o.append("<span class='pane-control pane-control-close' title='Close'></div>");s.prepend(o)}var u=$("<div class='pane-contents'></div>");u.append(n.contents());r.append(u);var a=u.children();t.hasContainer=a.length==1&&a.hasClass("pane-container");if(t.hasContainer){n.addClass("pane-has-container")}n.append(r);this.els.margin=r;this.els.caption=s;this.els.contents=u};r.initSize=function(e,t){var n=this.options,r=this.state;if("defaultFlexibleSize"in n){r.flexibleSize=n.defaultFlexibleSize}else{r.flexibleSize=t}r.staticSize=n["fixed"+(e?"Width":"Height")];this.updateSize(e);if(n.collapsed){this.toggleCollapsed()}};r.updateSize=function(e){var t=this.options,n=this.state;if(typeof e!="undefined"){n.isVertical=e}n.metric=e?"width":"height";var r=n.isVertical?n.fixedWidth:n.fixedHeight;n.isStatic=n.isCollapsed||!!r;if(n.isStatic&&!n.isCollapsed){n.staticSize=r}};r.toggleCollapsed=function(){var e=this.options,t=this.state;var n=this.els.pane;if(t.isMaximized){this.restore();setTimeout(Bound(this,this.toggleCollapsed),Panes.transitionDuration);return}t.isCollapsed=!t.isCollapsed;n.toggleClass("pane-minimized",t.isCollapsed);this.updateSize();if(t.isCollapsed){var r=this.els.caption.outerHeight();var i=parseInt(n.siblings(".pane-divider").css(t.isVertical?"width":"height"));var s=r+i/(t.isInMiddle?1:2);if(t.isVertical){this.els.caption.addClass("pane-caption-rotate")}t.staticSize=s+"px";this.els.contents.fadeOut(this.transitionDuration)}else{this.els.caption.removeClass("pane-caption-rotate");n.css("height","");this.els.contents.fadeIn(Panes.transitionDuration)}n.parent().Container().updateSizes()};r.float=function(e){if(e){this.floatOn()}else{this.floatOff()}};r.floatOn=function(){if(this.state.floating){return}var e=this.els.pane;this.floatData={pane:e};var t=e.offset();var n=$("body").offset();t.left-=n.left;t.top-=n.top;var r=$("<div class='pane-pane pane-placeholder'></div>");r.append("<div class='pane-margin'></div>");r.css("width",e[0].style.width).css("height",e[0].style.height);e.css("width",e.outerWidth()).css("height",e.outerHeight());e.after(r);e.removeClass("pane-transition");var i=$("> .pane-margin",e).boundingBox();e.css("left",i.left).css("top",i.top).css("width",i.width()).css("height",i.height());this.els.pane=r;r[0].paneData=this;var s=$("<div class='pane-container pane-bogus'/>");var o=e.parent().hasClass("pane-vertical");s.toggleClass("pane-vertical",o).toggleClass("pane-horizontal",!o);s.prependTo($("body"));s.append(e);this.floatData.paneOffset=t;this.floatData.panePlaceholder=r;this.floatData.bogusContainer=s;this.state.floating=true;e.addClass("pane-floating")};r.floatOff=function(){if(!this.state.floating){return}var e=this.floatData.pane;this.els.pane=e;var t=this.floatData.panePlaceholder;var n=e.parent().hasClass("pane-vertical");var r=t.parent().hasClass("pane-vertical");var i=n!=r;t.after(e);t.remove();this.floatData.bogusContainer.remove();e.css("left","").css("top","").css("width",t[0].style.width).css("height",t[0].style.height);this.updateSize(r);if(n!=r){if(this.state.isCollapsed){this.toggleCollapsed();this.toggleCollapsed()}}delete this.floatData;this.state.floating=false;e.removeClass("pane-floating")};r.movePanePlaceholder=function(e){var t=this.els.pane;var n=this.floatData.panePlaceholder;var r=n.next();var i=e[0]!=r[0];var s=e.parent();var o=n.parent();var u=s[0]!=o[0];var a=this.state.isVertical;var f=s.hasClass("pane-vertical");var l=a!=f;if(!i){return}e.after([n,r]);var c=e;$(".pane-was-drag-droppable").removeClass("pane-was-drag-droppable").addClass("pane-drag-droppable");c.toggleClass("pane-was-drag-droppable",c.hasClass("pane-drag-droppable"));c.removeClass("pane-drag-droppable");$(".pane-divider").removeClass("pane-transition");n.css("left","").css("top","").css("width",!f?"100%":u?0:n[0].style.width).css("height",f?"100%":u?0:n[0].style.height);n.addClass("pane-transition");this.update();this.updateSize(f);setTimeout(function(){s.Container().updateSizes();if(u){o.Container().updateSizes()}},0)};r.maximize=function(){if(this.state.isMaximized){return}var e=this.els.pane;if(this.state.isCollapsed){this.toggleCollapsed();setTimeout(Bound(this,this.maximize),Panes.transitionDuration);return}if($(".pane-maximized").length){$(".pane-maximized").Pane().restore();setTimeout(Bound(this,this.maximize),Panes.transitionDuration);return}this.float(true);e.addClass("pane-transition");setTimeout(function(){e.addClass("pane-maximized")},0);this.floatData.bogusContainer.addClass("pane-maximized");this.floatData.bogusContainer.css("background","none");var t=this;setTimeout(function(){t.floatData.bogusContainer.css("background","")},Panes.transitionDuration);this.state.isMaximized=true};r.restore=function(){if(!this.state.isMaximized){return}var e=this.floatData.pane;this.floatData.bogusContainer.css("background","none");e.removeClass("pane-maximized");var t=this.floatData.panePlaceholder;var n=$("> .pane-margin",t);var r=n.boundingBox();e.css("left",r.left).css("top",r.top).css("width",r.width()).css("height",r.height()).css("position","absolute").addClass("pane-transition");var i=this;setTimeout(function(){e.css("position","").removeClass("pane-transition");i.float(false);setTimeout(function(){e.addClass("pane-transition")},0)},Panes.transitionDuration);this.state.isMaximized=false};r.close=function(){if(this.state.isMaximized){this.restore();var e=this;setTimeout(function(){e.close()},Panes.transitionDuration);return}var t=this.els.pane;var n=t.parent();if(this.floatData){this.floatData.bogusContainer.remove()}t.next().remove();t.remove();n.Container().updateSizes()};return t}(),Dividers:{init:function(){DragCapture.onDragStart.register(Bound(this,this.onDragStart))},onDragStart:function(e,t,n){if(!e.hasClass("pane-divider")){return false}var r=e.parent().hasClass("pane-vertical");var i=e.prevAll(".pane-pane:not(.pane-minimized)"),s=e.nextAll(".pane-pane:not(.pane-minimized)");if(i.length==0||s.length==0){return false}i=$(i[0]);s=$(s[0]);var o=r?i.outerWidth():i.outerHeight();var u=r?s.outerWidth():s.outerHeight();dragInfo={divider:e,container:e.parent(),isVertical:r,mouseStart:r?t.x:t.y,prev:i,next:s,prevStatic:i.Pane().state.isStatic,nextStatic:s.Pane().state.isStatic,currentPrevSizePX:o,totalSizePX:o+u};var a=0;var f=i.Pane().state.flexibleSize;var l=s.Pane().state.flexibleSize;if(!dragInfo.prevStatic&&!dragInfo.nextStatic){a=f+l}else if(!dragInfo.prevStatic){a=f/o*dragInfo.totalSizePX}else if(!dragInfo.nextStatic){a=l/u*dragInfo.totalSizePX}dragInfo.totalSizePC=a;if(dragInfo.prevStatic){dragInfo.prevStaticRatio=numberAndRest(i.Pane().state.staticSize).number/o}if(dragInfo.nextStatic){dragInfo.nextStaticRatio=numberAndRest(s.Pane().state.staticSize).number/u}dragInfo.prev.removeClass("pane-transition");dragInfo.next.removeClass("pane-transition");n.onDragMove=Bound(this,this.onDragMove);n.onDragEnd=Bound(this,this.onDragEnd);n.dragExtra=dragInfo;return true},onDragMove:function(e,t,n,r){var i=e.divider;if(e.isVertical&&r.x==0||!e.isVertical&&r.y==0){return}var s=e.isVertical?n.x:n.y;var o=e.currentPrevSizePX+s;var u=o/e.totalSizePX*e.totalSizePC;var a=e.totalSizePX-o;var f=e.totalSizePC-u;if(u<.05||f<.05||o<20||a<20){return}if(e.prevStatic){var l=numberAndRest(e.prev.Pane().state.staticSize);e.prev.Pane().state.staticSize=o*e.prevStaticRatio+l.rest}else{e.prev.Pane().state.flexibleSize=u}if(e.nextStatic){var l=numberAndRest(e.next.Pane().state.staticSize);e.next.Pane().state.staticSize=a*e.nextStaticRatio+l.rest}else{e.next.Pane().state.flexibleSize=f}e.container.Container().updateSizes()},onDragEnd:function(e){e.container.Container().updateSizes();e.prev.addClass("pane-transition");e.next.addClass("pane-transition")}},Captions:{minimumDistanceForDragStart:3,dragging:false,setDroppableTargets:new CallbackQueue,init:function(){DragCapture.onDragStart.register(Bound(this,this.onDragStartPreStart))},createBoundingBoxes:function(e){if(typeof e=="undefined"){u=$(":not(.pane-contents) > .pane-container").toArray().map(Panes.Captions.createBoundingBoxes);return u}var e=$(e);var t=e.hasClass("pane-vertical");var n=e.boundingBox();var r=e.children(".pane-pane");var i=r.toArray().map(function(e){return $(e).boundingBox()});var s=e.children(".pane-divider");var o=s.toArray().map(function(e,r){var s=i[r-1],o=i[r];var u=new boundingBox(s||o||n);if(s){if(t){u.left=s.middleVertical()}else{u.top=s.middleHorizontal()}}if(o){if(t){u.right=o.middleVertical()}else{u.bottom=o.middleHorizontal()}}return{box:u,divider:$(e)}});var u=r.filter(".pane-has-container").toArray().map(function(e){var t=$("> .pane-margin > .pane-contents > .pane-container",e);return Panes.Captions.createBoundingBoxes(t)});return{box:n,children:u,dividerBoxes:o,divider:$(s[0])}},findDividerFromMouse:function(e,t){var n;for(var r=0,i;i=e[r];r++){if(i.box.contains(t)){n=this.findDividerFromMouse(i.children,t);if(n){return n}for(var s=0,o;o=i.dividerBoxes[s];s++){if(o.box.contains(t)){return o.divider}}return i.divider}}},onDragStartPreStart:function(e,t,n){if(e.hasClass("pane-caption-text")){e=e.parent()}if(!e.hasClass("pane-caption")){return false}var r=e.parent().parent();if(r.hasClass("pane-maximized")){return false}dragInfo={pane:r,mouseStart:t,dragStarted:false};n.onDragMove=Bound(this,this.onDragMovePreStart);n.onDragEnd=Bound(this,this.onDragEnd);n.onDragKeyDown=Bound(this,this.onDragKeyDown);n.dragExtra=dragInfo;return true},onDragStart:function(e,t,n){var r=e.pane;var i=r.Pane();if(this.setDroppableTargets.length){var s=this.setDroppableTargets.firstToAccept(r);if(typeof s=="undefined"){return}s=s.filter(".pane-divider")}else{s=$(".pane-divider")}s=s.not(r.next()).not($(".pane-divider",r));if(!s.length){return}this.dragging=true;i.float(true);var o=i.floatData.panePlaceholder;o.addClass("pane-drag-droppable");var u=i.floatData.bogusContainer;var a=i.floatData.paneOffset;a.left+=n.x;a.top+=n.y;r.addClass("pane-dragged");s.addClass("pane-drag-droppable");s.parent().addClass("pane-drag-droppable");var f=o.prev();f.toggleClass("pane-was-drag-droppable",f.hasClass("pane-drag-droppable"));f.removeClass("pane-drag-droppable");e.paneOffset=a;e.panePlaceholder=o;e.bogusContainer=u;e.dragStarted=true;e.boundingBoxes=this.createBoundingBoxes();e.pauseMovePlaceholder=false;this.onDragMove(e,t,n,n)},onDragMovePreStart:function(e,t,n,r){if(e.dragStarted){this.onDragMove(e,t,n,r)}else{var i=Math.sqrt(n.x*n.x+n.y*n.y);if(i>=this.minimumDistanceForDragStart){this.onDragStart(e,t,n)}}},onDragMove:function(e,t,n,r){if(r.x==0&&r.y==0){return}var i=e.pane;var s=i.Pane().floatData.paneOffset;i.css("left",n.x+s.left).css("top",n.y+s.top);if(e.pauseMovePlaceholder){return}$(".pane-drag-over").removeClass("pane-drag-over");e.divider=this.findDividerFromMouse(e.boundingBoxes,t);if(e.divider){e.divider.addClass("pane-drag-over");this.movePanePlaceholder(e)}},movePanePlaceholder:function(e){e.pane.Pane().movePanePlaceholder(e.divider);e.pauseMovePlaceholder=true;var t=this;setTimeout(function(){e.boundingBoxes=t.createBoundingBoxes();e.pauseMovePlaceholder=false},Panes.transitionDuration/2)},onDragEnd:function(e){if(!e.dragStarted){return}$(".pane-drag-over").removeClass("pane-drag-over");$(".pane-dragged").removeClass("pane-dragged");$(".pane-drag-droppable").removeClass("pane-drag-droppable");$(".pane-was-drag-droppable").removeClass("pane-was-drag-droppable");$(".pane-divider").removeClass("pane-transition");var t=e.pane;var n=t.Pane();n.float(false);t.addClass("pane-transition");this.dragging=false}},ControlBoxes:{init:function(){this.initEventHandlers()},initEventHandlers:function(){$(".pane-control-minimize").click(this.onMinimize);$(".pane-control-maximize").click(this.onMaximize);$(".pane-control-restore").click(this.onRestore);$(".pane-control-close").click(this.onClose)},onMinimize:function(){if(Panes.Captions.dragging){return}$(this).Pane().toggleCollapsed()},onMaximize:function(){if(Panes.Captions.dragging){return}var e=$(this).closest(".pane-pane");var t=e.Pane();t.maximize()},onRestore:function(){if(Panes.Captions.dragging){return}var e=$(this).closest(".pane-pane");var t=e.Pane();t.restore()},onClose:function(){if(Panes.Captions.dragging){return}var e=$(this).closest(".pane-pane");var t=e.Pane();if(!t.confirmedClose){if(!confirm("Are you sure you want to close this?")){return}}t.close()}}}